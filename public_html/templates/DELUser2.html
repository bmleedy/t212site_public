<script type="text/javascript">
  var $user_type;  function toggleDiv(divName) {    $('#' + divName).toggle();  }
  function editDoc() {    strURL = location.href + "&edit=1";    location.href = strURL;  }
  function submitDoc() {    var mb_list = [];    var id = $('#user_id').val();    var inputElements = document.getElementsByClassName('mbCheckbox');    for (var i = 0; inputElements[i]; ++i) {      if (inputElements[i].checked) {        mb_list.push(inputElements[i].value);      }    }    console.log(mb_list);    var fieldData = {      "user_type": $user_type,      "first": $('#user_first').val(),      "last": $('#user_last').val(),      "email": $('#user_email').val(),      "rank": $('#rank').val(),      "patrol": $('#patrol').val(),      "position": $('#position').val(),      "phone_1": $('#user_phone_1').val(),      "phone_2": $('#user_phone_2').val(),      "phone_3": $('#user_phone_3').val(),      "phone_type_1": $('#phone_type_1').val(),      "phone_type_2": $('#phone_type_2').val(),      "phone_type_3": $('#phone_type_3').val(),      "phone_id_1": $('#phone_id_1').val(),      "phone_id_2": $('#phone_id_2').val(),      "phone_id_3": $('#phone_id_3').val(),			"address1" : $('#address1').val(),      "address2" : $('#address2').val(),      "city" : $('#city').val(),      "state" : $('#state').val(),      "zip" : $('#zip').val(),      "scout_1": $('#scout_1').val(),      "scout_2": $('#scout_2').val(),      "scout_3": $('#scout_3').val(),      "scout_4": $('#scout_4').val(),      "mb_list": mb_list,      "id": id    };
    $.ajax({      url: "api/updateuser2.php",      type: "post",      datatype: 'json',      data: fieldData,      error: function (XMLHttpRequest, textStatus, errorThrown) {        console.log(errorThrown);      },      success: function (data) {        console.log(data);        if (data["status"] == "validation") {          alert(data["message"]);          $("#" + data["field"]).focus()        } else if (data["status"] == "Success") {          alert("Details have been updated!");          strURL = "User.php?id=" + id;          location.href = strURL;        }      }    })  }
  function selectScout(element, index, array) {    fldIndex = index + 1;    $('#scout_' + fldIndex).val(element);  }
  function setButtons(varEdit, showEdit) {    if ((varEdit == "1") || (strID == "New")) {      buttonData = '<a onclick="submitDoc()" class="round small button">Submit</a><div class="clearfix"></div>';    } else {      if (showEdit == "1") {        buttonData = '<a onclick="editDoc();" class="round small button">Edit</a><div class="clearfix"></div>';      }    }    $('#userButtons').append(buttonData);  }
  $(document).ready(function () {    strID = document.getElementById('user_id').value;    varEdit = document.getElementById('edit').value;    showEdit = document.getElementById('showEdit').value;    var fieldData = {      "id": strID,      "edit": varEdit,      "showEdit": showEdit    };    $.ajax({      url: "api/getuser2.php",      type: "post",      data: fieldData,      datatype: 'json',      error: function (XMLHttpRequest, textStatus, errorThrown) {        console.log("error .ready");      },      success: function (data) {        $('#userData').append(data);      }    });    $.ajax({      url: "api/getOtherUserInfo2.php",      type: "post",      data: fieldData,      datatype: 'text',      error: function (XMLHttpRequest, textStatus, errorThrown) {        console.log("error .ready");        console.log(textStatus);      },      success: function (data) {        if (data["profile"] == "no") {          alert('You must complete your profile before using this site.');        }        console.log(data);        $user_type = data['user_type'];        $('#scoutData').append(data['scoutData']);        if ($user_type != "Scout") {          $('#mb_panel').append(data['mbData']);          toggleDiv("divMB");          i = 1;          if (varEdit) {            data['scouts'].forEach(selectScout);          }        }      }    });
    setButtons(varEdit, showEdit);
    $(document).foundation();
  })
</script>
<form id="myForm">

	<div id="userData"></div>
	<div id="scoutData"></div>
	<div id="userButtons"></div>
	<div class="row" style="display:none" id="divMB">
		<div class="large-12 columns">		
			<dl class="accordion" data-accordion>
				<dd class="accordion-navigation">
					<a href="#mb_panel">Merit Badges</a>
					<div id="mb_panel" class="content active">
					</div>
				</dd>
			</dl>
		</div>
	</div>
	
</form>

